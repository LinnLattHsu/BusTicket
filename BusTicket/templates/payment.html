<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Details - Your Booking</title>
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Light gray background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }
        .container-custom {
            max-width: 500px;
            width: 100%;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            padding: 32px;
            margin: 20px;
        }
        /* Custom style for the gradient button, as Bootstrap doesn't have this directly */
        .pay-button {
            background-image: linear-gradient(to right, #4ade80, #22c55e); /* Green gradient */
            color: white;
            padding: 14px 24px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 18px;
            width: 100%;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: none;
            box-shadow: 0 4px 10px rgba(34, 197, 94, 0.3);
        }
        .pay-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(34, 197, 94, 0.4);
        }
        .pay-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(34, 197, 94, 0.2);
        }
        .message-box {
            padding: 16px;
            border-radius: 8px;
            margin-top: 20px;
            display: none; /* Hidden by default */
            text-align: center;
            font-weight: 500;
        }
        .message-box.info {
            background-color: #e0f2fe; /* Light blue */
            border: 1px solid #90cdf4;
            color: #2b6cb0;
        }
        .message-box.success {
            background-color: #d1fae5; /* Light green */
            border: 1px solid #6ee7b7;
            color: #065f46;
        }
        .message-box.error {
            background-color: #fee2e2; /* Light red */
            border: 1px solid #fca5a5;
            color: #991b1b;
        }
    </style>
</head>
<body>
    <p>{{schedule_id}}</p>
        <p>{{total_amount}}</p>
    <p>{{selected_seats}}</p>

<!--    <div class="container-custom">-->
<!--        <h1 class="text-center text-dark fw-bold mb-4">Payment Details</h1>-->

<!--        &lt;!&ndash; Booking Summary Section - Added details from session &ndash;&gt;-->
<!--        <div class="bg-info-subtle p-4 rounded-3 mb-4 shadow-sm">-->
<!--            <h5 class="fw-bold text-info-emphasis mb-3">Your Booking Summary</h5>-->
<!--            <p class="mb-1">Bus/Schedule ID: <strong class="text-dark">{{ schedule_id }}</strong></p>-->
<!--            <p class="mb-1">Selected Seats: <strong class="text-dark">{{ selected_seats }}</strong></p>-->
<!--            <hr class="my-2">-->
<!--            <div class="d-flex justify-content-between align-items-center">-->
<!--                <span class="fs-5 fw-semibold text-body-secondary">Total Amount:</span>-->
<!--                <span class="fs-3 fw-bold text-primary">$<span id="totalAmount">{{ total_amount|floatformat:2 }}</span></span>-->
<!--            </div>-->
<!--        </div>-->

<!--        <form id="paymentForm" class="row g-4">-->
<!--            <div>-->
<!--                <label for="userEmail" class="form-label text-body-secondary fw-medium">Your Email</label>-->
<!--                &lt;!&ndash; This email will come from the logged-in user object &ndash;&gt;-->
<!--                <input type="email" id="userEmail" name="userEmail" class="form-control" value="{{ user_email }}" readonly>-->
<!--            </div>-->

<!--            <div>-->
<!--                <label for="cardNumber" class="form-label text-body-secondary fw-medium">Card Number</label>-->
<!--                <input type="text" id="cardNumber" name="cardNumber" class="form-control" placeholder="**** **** **** ****" minlength="16" maxlength="19" required>-->
<!--            </div>-->

<!--            <div>-->
<!--                <label for="cardName" class="form-label text-body-secondary fw-medium">Cardholder Name</label>-->
<!--                <input type="text" id="cardName" name="cardName" class="form-control" placeholder="John Doe" required>-->
<!--            </div>-->

<!--            <div class="col-md-6">-->
<!--                <label for="expiryMonth" class="form-label text-body-secondary fw-medium">Expiry Month</label>-->
<!--                <input type="text" id="expiryMonth" name="expiryMonth" class="form-control" placeholder="MM" minlength="2" maxlength="2" required>-->
<!--            </div>-->
<!--            <div class="col-md-6">-->
<!--                <label for="expiryYear" class="form-label text-body-secondary fw-medium">Expiry Year</label>-->
<!--                <input type="text" id="expiryYear" name="expiryYear" class="form-control" placeholder="YY" minlength="2" maxlength="2" required>-->
<!--            </div>-->

<!--            <div class="col-12">-->
<!--                <label for="cvv" class="form-label text-body-secondary fw-medium">CVV</label>-->
<!--                <input type="text" id="cvv" name="cvv" class="form-control" placeholder="123" minlength="3" maxlength="4" required>-->
<!--            </div>-->

<!--            <div class="col-12 mt-4">-->
<!--                <button type="submit" class="pay-button">Pay Now</button>-->
<!--            </div>-->
<!--        </form>-->

<!--        &lt;!&ndash; Message Box for feedback &ndash;&gt;-->
<!--        <div id="messageBox" class="message-box"></div>-->
<!--    </div>-->

    <!-- Bootstrap JS Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const paymentForm = document.getElementById('paymentForm');
            const messageBox = document.getElementById('messageBox');

            // --- Basic form validation and submission ---
            paymentForm.addEventListener('submit', (event) => {
                event.preventDefault(); // Prevent default form submission

                // Simple validation example
                const cardNumber = document.getElementById('cardNumber').value;
                const cardName = document.getElementById('cardName').value;
                const expiryMonth = document.getElementById('expiryMonth').value;
                const expiryYear = document.getElementById('expiryYear').value;
                const cvv = document.getElementById('cvv').value;

                if (!cardNumber || !cardName || !expiryMonth || !expiryYear || !cvv) {
                    showMessage('Please fill in all required fields.', 'error');
                    return;
                }

                if (cardNumber.length < 16 || isNaN(cardNumber.replace(/\s/g, ''))) {
                    showMessage('Please enter a valid card number (16 digits).', 'error');
                    return;
                }

                const currentYear = new Date().getFullYear() % 100;
                const currentMonth = new Date().getMonth() + 1;

                const expMonthNum = parseInt(expiryMonth);
                const expYearNum = parseInt(expiryYear);

                if (expiryMonth.length !== 2 || isNaN(expMonthNum) || expMonthNum < 1 || expMonthNum > 12) {
                    showMessage('Please enter a valid 2-digit expiry month (e.g., 01-12).', 'error');
                    return;
                }

                if (expiryYear.length !== 2 || isNaN(expYearNum) || expYearNum < currentYear || (expYearNum === currentYear && expMonthNum < currentMonth)) {
                    showMessage('Please enter a valid future expiry year/month.', 'error');
                    return;
                }

                if (cvv.length < 3 || cvv.length > 4 || isNaN(cvv)) {
                    showMessage('Please enter a valid 3 or 4-digit CVV.', 'error');
                    return;
                }

                // Simulate payment processing
                showMessage('Processing your payment...', 'info');

                setTimeout(() => {
                    const isSuccess = Math.random() > 0.1; // 90% chance of success

                    if (isSuccess) {
                        showMessage('Payment successful! Thank you for your purchase.', 'success');
                        // In a real Django app, you would submit this form data to a Django view
                        // that handles payment processing (e.g., interacts with a payment gateway)
                        // and then redirects to a confirmation page.
                        // Example: paymentForm.submit();
                    } else {
                        showMessage('Payment failed. Please check your details and try again.', 'error');
                    }
                }, 2000);
            });

            // --- Function to display messages ---
            function showMessage(message, type) {
                messageBox.textContent = message;
                messageBox.style.display = 'block';

                messageBox.classList.remove('info', 'success', 'error');

                if (type === 'success') {
                    messageBox.classList.add('success');
                } else if (type === 'error') {
                    messageBox.classList.add('error');
                } else { // info or default
                    messageBox.classList.add('info');
                }

                if (type !== 'error') {
                    setTimeout(() => {
                        messageBox.style.display = 'none';
                    }, 5000);
                }
            }

            // --- Auto-format card number with spaces ---
            document.getElementById('cardNumber').addEventListener('input', function (e) {
                let value = e.target.value.replace(/\s+/g, '');
                let formattedValue = '';
                for (let i = 0; i < value.length; i++) {
                    if (i > 0 && i % 4 === 0) {
                        formattedValue += ' ';
                    }
                    formattedValue += value[i];
                }
                e.target.value = formattedValue;
            });

            // --- Limit expiry month/year and CVV to numbers ---
            document.getElementById('expiryMonth').addEventListener('input', function (e) {
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
            });
            document.getElementById('expiryYear').addEventListener('input', function (e) {
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
            });
            document.getElementById('cvv').addEventListener('input', function (e) {
                e.target.value = e.target.value.replace(/[^0-9]/g, '');
            });
        });
    </script>
</body>
</html>
